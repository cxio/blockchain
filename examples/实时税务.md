## 实时税务

**注**：假设为一种新的监管方式。


### 前言

一个实体向企业支付的币金脚本中，可以包含财务汇报的逻辑。这些币金不是在企业收款时主动汇报，而是在使用时由代码中的汇报逻辑强制执行：当输出作为新交易的输入时脚本代码被执行。

财务汇报的逻辑并不由企业自己掌控，它们由支付币金给企业的实体书写，因此除非合谋，理论上企业无法作弊。


### 企业身份

从数字安全的角度来说，企业的身份需要认证，它可能由企业的官方签名来实施。因此财务汇报还需要企业提供签名来确认。

给企业支付币金的实体无法知道企业情况，当然也无需置入企业签名的验证代码，但是需要提供签名数据的跳转逻辑：跳转到财务汇报管理机构预先发布的管理者交易。这里，接收财务汇报的管理机构是已知的，那些管理者交易也是已知的。


### 脚本

#### 检查财务信息的监管脚本

携带监管脚本的管理者交易需要先发布，用于适用企业的财务汇报。这样的监管脚本通常有足够长的有效期。

假设该管理者交易被收录在第 `57043` 号区块，交易ID为 `0xa1075db55d416d3ca199f55b6084e2115b9345e16c5cf302fc80e9d5fbf5d48d`，监管脚本为交易中唯一的输出项（即脚本在输出集中下标为 `0`）。

```go
@SHIFT[2]           // 提取传入的2项参数
OUTPUT BUFDUMP      // 导出并触发监管服务器上的App，执行验证和登记等相关工作

TRUE PASS           // 允许企业花费（无条件通过）
```

> **附注：**<br>
> 监管脚本通常是独立的逻辑，由GOTO指令跳转过来，需要处理PASS逻辑。<br>


#### 嵌入监管逻辑的付款脚本

```go
// 解锁参数
// <sig> <pubKey>...            // 系统内置验证方式，略
// <sigCorpData>                // 企业签名数据，企业自己提供

// 锁定脚本
IN{Amount}                      // 花费的币金数量
@SHIFT[2]                       // 提取企业签名数据和转出金额
GOTO[57043, 0xa1075db5..., 0]   // 跳转到上面的管理者交易的监管脚本

// 花费许可将由监管脚本控制，
// 因为监管脚本已知，所以许可情况明确。
```


### 备注

**这并不是企业传统报税的流程，而仅是假想了一种可能，说明某种逻辑上的可行性。**
