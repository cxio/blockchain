///////////////////////////////////////
// 较大修改说明
///////////////////////////////////////

## 哈希安全性
// 2025-10-26

考虑未来的量子安全，交易和区块的哈希算法由原来的**SHA-384**，改为**SHA3-512**。
附件分片哈希和公钥地址保护哈希依然采用**SHA-384**，以节省计算资源和存储空间。

**说明：**
- 区块和交易需要长期安全，因此采用更强的哈希算法。虽然区块拥有UTXO指纹的额外耦合保护。
- 附件也需要长期安全，虽然分片哈希仅用**SHA-384**，但附件还有数据指纹（SHA: 320-512）的二重保护。
- 公钥地址哈希采用48字节强度，因为内层只是公钥（还有非对称算法保护）。短一些长度更友好。


## 确定性年度引用
// 2025-10-26

交易输入项的引用中：由原来的**区块年度**（交易实际所在区块），改为交易创建时的**交易年度**（交易时间戳所在年度）。

### 变更原因

1. 区块年度可能导致跨年度时，如果出现分叉，回收的交易不在原分叉上的同样年度，从而导致输入项引用失效的问题。
2. 交易年度由时间戳决定，拥有确定性，与它被收录入哪个区块无关。不会出现引用失效的问题。

> **注：**
> 设计中存在交易过期规则，太旧的交易不会进入区块。因此新的交易不会牵涉已经固化下来的存储结构。


## 抽查评估的问题
// 2025-10-26

对于附件数据的存储，如果用分片抽查来测试目标节点是否存储了数据，会有作弊的问题：目标节点可以通过向其它节点请求数据来返回抽查请求，从而通过测试。

这是一种窃取行为，无法达成抽查的目的。

扩展来看，约束性的“抽查”逻辑，实际上没有意义。节点可以通过各种方式来作弊。因此，约束性的强制机制应当被放弃。

节点应当用实际的服务（质量）来综合评估，这是正向的，它针对的是真实的需求。


## 自签名证书
// 2025-10-30

自签名证书不使用一次性动态创建（App启动时），而是应当含有一个合理的较短有效期。

这样可以避免App频繁重启带来的证书更换问题，因为证书的 SPKI（Subject Public Key Info）指纹可能已经发布到 Findings 网络中。


## 铸凭哈希设计
// 2025-11-18

铸凭哈希的设计中，恢复了 UTXO 指纹作为计算因子之一。这是因为：

- 若单纯依靠铸凭哈希可能导致“拥有大量交易”者预估择优池冠军，并据此塑造交易，甚至获得持续优势。
- 恢复UTXO指纹参与计算，虽然存在弱塑造（高成本），但交易ID因子就无法塑造了。
