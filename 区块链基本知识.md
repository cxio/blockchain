# 区块链基本知识

## 交易

入账和出账的记录，表达信用的转移。入账来源于另一笔出账（属主）。

在区块链中，入账就是交易的输入部分，出账则是输出部分。输入部分来源于另一笔交易的输出（即拥有者）。


### 出账（输出）

资金的归属、去向。

在Bitcoin中由金额和输出脚本（锁定脚本）表达，只要谁能提供解锁数据让脚本执行成功，谁就是它的主人。


### 入账（输入）

资金的来源，谁拥有该笔资金，对应前一笔交易的输出（属主）。

Bitcoin中的资金是由铸币交易（Coinbase）凭空创建的，每一个区块里都有一笔铸币交易。铸币交易能创建多少币金有着预定的规则。

入账部分可以有多个输入条目，出账部分也同样。


### 找零（输出）

Bitcoin中没有账户余额的概念，每一笔输出都必须花完。如果付款目标不需要那么多，则剩余部分只能转移另一个新地址。这就是找零。当然，找零地址肯定是你自己的私钥创建的。**注**：地址为私钥对应的公钥的哈希。

找零地址也可以设定为你原来入账的那个地址。但出于安全性，Bitcoin不推荐这样做。


### 附：哈希算法

哈希并不是加密，而是一种数据摘要的算法：任意大小的数据通过各种处理，最终收敛到一段固定长度的序列（如32字节）。

算法保证原始数据即便只有很微小的变动，最终收敛的结果都会差异明显。因此一段数据的哈希结果也被称为数据的“指纹”。哈希运算是不可逆的，你不能经由结果逆向推导出原始的数据。


### 匿名性

交易被收录入区块，区块被公开发布到网上，因此交易都是公开全网可见的。

> **注：**
> 交易不能被加密，因为它需要被所有的节点验证，检查其是否合法。

交易的匿名性来源于收款地址的匿名性。地址是私钥的公钥生成的，可以任意创建，不与任何现实的人类个体相关联。这与传统的银行账户系统逻辑不同。为了增强隐私性，Bitcoin鼓励你每一次转账都应当使用一个新地址。

但这种隐私性设计在现实中并不足够，一旦你的交易与现实挂钩，就可能被逆向追溯。

> **注：**
> 传统银行对系统之外的公众隐秘，内部却是实名可知的。



## 区块

区块是交易的集合，一笔交易如果被区块收录，即表示该笔交易已经上链（被确认）。

区块有一些简单的结构，区块ID即为对这种结构的哈希摘要，可以保证一旦内部数据有变，ID也必然改变。也即：区块ID是区块的指纹。



## 区块链

每一个区块都会引用上一个区块的ID（包含在它的区块头中），因此一旦上一个区块的内容改变，其ID就会变化，进而下一个引用其ID的区块也会改变……如此链式传递：自内容改变的区块之后，所有的区块都连锁变化。

这就是区块链*防篡改*的机制。不是它可以阻止改变，而是改变之后会导致后续所有数据的改变……即：攻击者无法悄悄地改变历史。

历史数据被这种链式结构**锁死**了——如果公众已经确定了当前区块的ID，篡改就无法完成。



## 铸造共识

交易已经验证，每一个节点都可以打包交易创建区块，这是正常的逻辑。但区块只能有一个，由谁来创建呢？这就需要共识。

Bitcoin中采用工作量证明（PoW: Proof of Work）来决出胜者，Peercoin中则采用权益证明（PoS: Proof of Stake）来竞争。

区块中的首笔交易为铸币交易（Coinbase），由区块的创建者构建。铸币交易会生成币金（无中生有），这是必须的，也是一种经济激励。



## 关联概念

### 去中心化

传统的体系通常是中心化的，比如公司：董事会做决策，下级负责执行，权力在少数人手中。

去中心化逆向这种逻辑：各个部分都是平等的，它们通过某种共识来做事。没有谁拥有绝对的权力，绝对权力只属于“共识”本身。也因此，去中心化的系统不怕失去谁，十分的强壮。这是一种无控制中心的逻辑（类似Internet本身）。


### 去中介化

去中介化只是一种应用层面的事物，即：无需借助于中介服务，客户和服务端可以直接交互完成业务。

逻辑上看，去中介化既可以借助于传统的互联网实施，也可以籍由去中心化系统完成。只是由去中心化系统来完成的话，可能更彻底一些。


### 分布式

分布式和去中心化没有必然的连系。分布式只是描述了一种网络拓扑结构，执行单元不在同一个机房里而已。因为网络连接的便捷性，执行单元可以分布在不同的地理位置，甚至全球。

分布式系统通常是中心化的，有一个控制中心和几个备用控制中心，它们不是去中心化系统。


### 私有链

区块链并不必然是去中心化的，它完全可以由一个中心化实体运作：参与的节点都由实体控制即可。

私有链就是这样的逻辑，所有的节点都由一个实体拥有和部署，因为存在统一控制，所以实际上这样的系统可以不需要共识。单一识即可。

区块链天然适合分布式部署，抗宕机能力强，网络强壮。这是中心化实体使用私有区块链的原因。


### 联盟链

类似于私有链的开放扩展版，不过由多个实体共同参与，共同控制。本质上看，它并不是真正的去中心化系统。

联盟链往往需要许可才能进入。它们提取了区块链的优点，同时又拥有控制的主权。


### 公有链

区块链最初的逻辑和愿景，一个自由开放式的去中心化的可信网络，起源于Bitcoin非主权电子现金的系统设计。

与上面两种私有属性的区块链不同，公有链是真正的去中心化的，无主权，就像互联网或大自然本身一样。

> **注：**
> P2P只是一种连接技术，与节点是否拥有自由没有必然的联系。
